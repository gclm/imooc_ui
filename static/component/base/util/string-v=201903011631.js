String.prototype.strLen=function(){for(var h=0,i=0;i<this.length;i++)this.charCodeAt(i)>255||this.charCodeAt(i)<0?h+=2:h++;return h},String.prototype.strToChars=function(){for(var h=new Array,i=0;i<this.length;i++)h[i]=[this.substr(i,1),this.isCHS(i)];return String.prototype.charsArray=h,h},String.prototype.isCHS=function(i){return this.charCodeAt(i)>255||this.charCodeAt(i)<0?!0:!1},String.prototype.subCHString=function(h,a){var c=0,g="";this.strToChars();for(var i=0;i<this.length;i++){if(this.charsArray[i][1]?c+=2:c++,c>a)return g;c>h&&(g+=this.charsArray[i][0])}return g},String.prototype.subCHStr=function(h,a){return this.subCHString(h,h+a)};