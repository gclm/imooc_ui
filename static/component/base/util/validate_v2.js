var validateCallback={};W={},function(a,c){W.ValidaterClass=function(){this.validateRules={"require-word":{type:"regex",extract:"value",regex:/^[^._$]+$/g,errorHint:'格式不正确，请输入除".","_"和"$"以外的字符'},"require-letter":{type:"regex",extract:"value",regex:/^[a-zA-Z0-9_]+$/g,errorHint:"格式不正确，请输入字母、数字、下划线"},"require-int":{type:"regex",extract:"value",regex:/^-?\d+$/g,errorHint:"格式不正确，请输入整数"},"require-positive-int":{type:"regex",extract:"value",regex:/^[1-9][0-9]*$/g,errorHint:"格式不正确，请输入正整数"},"require-nonnegative":{type:"regex",extract:"value",regex:/^\d+$/g,errorHint:"请输入非负整数"},"require-float":{type:"regex",extract:"value",regex:/^\d{1,5}(\.\d{1,2})?$/g,errorHint:"格式不正确，请输入'3.14'或'5'这样的数字"},"require-float-three":{type:"regex",extract:"value",regex:/^\d{1,5}(\.\d{1,3})?$/g,errorHint:"格式不正确，请输入'3.147'或'5'这样的数字"},"require-float-one":{type:"regex",extract:"value",regex:/^\d{1,5}(\.\d{0,1})?$/g,errorHint:"格式不正确，请输入'3.147'或'5'这样的数字"},"require-price":{type:"regex",extract:"value",regex:/^\d+(\.\d{0,2})?$/g,errorHint:"价格不正确，请输入0-999999999之间的价格"},"require-date":{type:"regex",extract:"value",regex:/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/g,errorHint:"输入格式为2013-01-01的日期"},"require-percent":{type:"regex",extract:"value",regex:/^([1-9]|[1-9]\d|100)$/g,errorHint:"格式不正确，请输入1-100的整数"},"require-tel-phone":{type:"regex",extract:"value",regex:/^(([0\+]\d{2,3}-)?(0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/g,errorHint:"输入的电话号码有错误。区号和电话号码之间请用-分割"},"require-email":{type:"regex",extract:"value",regex:/^[a-zA-Z0-9]+([._\-]*[a-zA-Z0-9]+)*@([a-zA-Z0-9]+([._\-][a-zA-Z0-9]+))+$/,errorHint:"邮箱格式错误"},"require-mobile-phone":{type:"regex",extract:"value",regex:/^(13[0-9]|15[012356789]|17[1356780]|18[0-9]|14[579])[0-9]{8}$/g,errorHint:"手机号格式错误"},"require-password":{type:"regex",extract:"value",regex:/^[\w~`!@#$%&*.,()_+<>?:"'+*\/\-\^\\\][{}]{6,16}$/,errorHint:"请输入6-16位密码，区分大小写，不能使用空格！"},"require-nick":{type:"regex",extract:"value",regex:/^[\w\u4E00-\u9FA5]{2,18}$/,errorHint:"昵称2-18位中英文、数字及下划线！"},"require-notempty":{type:"function",extract:"element",check:function(c){var g=a.trim(c.val());return 0==g.length?(this.errorHint="内容不能为空",!1):!0},errorHint:""},"require-element-exist":{type:"function",extract:"element",check:function(a){var c=a.data("selector");return a.find(c).length>0?!0:!1}},"require-string":{type:"function",extract:"element",check:function(c){var g=a.trim(c.val());"true"==c.attr("contenteditable")&&(g=c.attr("value"));var v=c.data("minlength")||c.data("min-length")||1,h=c.data("maxlength")||c.data("max-length")||9999999,H=g.length;return v>H||H>h?(this.errorHint=9999999==h?"输入值长度必须大于等于"+v:"请输入长度在"+v+"到"+h+"之间的字符串",!1):!0},errorHint:""},"require-select":{type:"function",extract:"value",check:function(c){var g=a.trim(c);return 0==g.length||"-1"===g?!1:!0},errorHint:"请选择一个选项"},"require-select-positive-option":{type:"function",extract:"value",check:function(a){var a=parseInt(a);return 0>a?!1:!0},errorHint:"请选择一个选项"},"require-custom-function":{type:"function",extract:"element",check:function(a){var c=a.attr("data-validate-function"),g=window[c](a);return this.errorHint=g.errorHint,g.isValidate||this.errorHint||(this.errorHint="请在data-validate-function函数中返回errorHint"),g.isValidate}},"require-file":{type:"function",extract:"value",check:function(a){return 0==a.length?!1:!0},errorHint:"请选择一份文件"},"require-length":{type:"function",extract:"element",check:function(c){var g=a.trim(c.val());"true"==c.attr("contenteditable")&&(g=c.attr("value"));var v=parseInt(c.attr("strlength"))||parseInt(c.attr("str-length")),h=g.length;return h!==v?(this.errorHint="请输入长度为"+v+"的字符串",!1):!0},errorHint:""}},this.getRule=function(a){return this.validateRules[a]}},W.Validater=new W.ValidaterClass,W.validate=function(c){var g=[];g.push(c?c.attr("data-validate")?c:c.find("[data-validate]"):a("[data-validate]"));for(var v=!1,h=g.length,H=null,i=0;h>i;++i){var y=g[i];y.each(function(){var c=a(this);if(!(c.is(":visible")&&"hidden"!=c.css("visibility")||c.data("forceValidate")))return void W.validate.toggleErrorHint(c,!0);var g=c.val(),h=c.attr("data-validate");if(h)for(var y=h.split(",,"),k=y.length,b=0;k>b;++b){var C=a.trim(y[b]);if("norequire"==C&&0==g.length){W.validate.toggleErrorHint(c,!0);break}var $=C.split("::"),E=null,w=null,V=null;2===$.length?(E=$[0],V=$[1]):E=$[0];var A=E.indexOf("(");-1!==A&&($=E.split("("),E=$[0],w=$[1].substring(0,$[1].length-1).split(","));var _=W.Validater.getRule(E);if(_)if("function"===_.type){var z=g,Z=c;if("element"==_.extract&&(z=c),!_.check.call(_,z,w))return v=!0,H=V?V:_.errorHint,W.validate.toggleErrorHint(Z,!1,H),!0;var R=c.attr("data-callback");if(R&&validateCallback&&validateCallback[R]){var I=c.val();if(validateCallback.errorHint="",validateCallback[R](I),!validateCallback.rel)return v=!0,W.validate.toggleErrorHint(Z,!1,validateCallback.errorHint,!0),!0;W.validate.toggleErrorHint(Z,!0),v=!1}else v=!1,W.validate.toggleErrorHint(Z,!0)}else if("regex"===_.type){var Z=c;if(!g.match(_.regex))return v=!0,H=V?V:_.errorHint,W.validate.toggleErrorHint(Z,!1,H),!0;var R=c.attr("data-callback");if(R&&validateCallback&&validateCallback[R]){var I=c.val();if(validateCallback.errorHint="",validateCallback[R](I),!validateCallback.rel)return v=!0,W.validate.toggleErrorHint(Z,!1,validateCallback.errorHint,!0),!0;W.validate.toggleErrorHint(Z,!0),v=!1}else v=!1,W.validate.toggleErrorHint(Z,!0);if(v)return!1}}})}return!v},W.validate.toggleErrorHint=function(g,v,h,H){if(g){var y=g.siblings(".errorHint");if(0==y.length){var k=g.parent();y=k.find(".errorHint")}if(0==y.length&&(y=g.parents(".xa-errorHintContainer").find(".errorHint")),0==y.length&&(y=g.parents(".x-errorHintContainer").find(".errorHint")),0==y.length){var b=g.data("errorHintTarget");b&&(y=a(b))}if(y.length>0)if(v)y.html("");else{var C=y.data("errorHint");H||C&&(h=C),y.html(h).show()}v||g.attr("errorhint-value")==c||g.attr("errorhint-value",h);var $=g.parent(),W="input"===g.get(0).tagName.toLowerCase();W&&(v?$.removeClass("has-error"):$.addClass("has-error"))}},a(document).delegate("input[data-validate]","blur",function(c){W.validate(a(c.currentTarget).parent())})}(jQuery);